# Web 应用使用指南

## 🎯 快速开始

### 第一步：启动服务器

```bash
cd /Users/shangwenxue/work/swx/color

# 方式 1: 使用启动脚本（推荐）
bash run_server.sh

# 方式 2: 直接运行
source venv/bin/activate
python app.py

# 方式 3: 指定端口
python app.py --port 8000
```

### 第二步：打开浏览器

访问 `http://localhost:5000`

### 第三步：开始使用

按照界面提示上传图像并执行颜色校正。

## 📸 使用流程

### 1. 上传校准图像

**要求**:
- 包含 ColorChecker 24 色卡
- 色卡清晰可见
- 光线条件良好
- 色卡占据图像 20-50%

**操作**:
- 点击上传区域或拖拽文件
- 等待上传完成
- 查看预览图像

### 2. 上传目标图像

**要求**:
- 需要校正的照片
- 与校准图像在相同光源条件下拍摄
- 支持 JPG、PNG、BMP、TIFF 格式

**操作**:
- 点击上传区域或拖拽文件
- 等待上传完成
- 查看预览图像

### 3. 检测色卡

**操作**:
- 点击"🔍 检测色卡"按钮
- 等待检测完成
- 查看检测结果和置信度

**结果解释**:
- 置信度 > 90%: 优秀
- 置信度 70-90%: 良好
- 置信度 < 70%: 需要改进

### 4. 选择校正方法

**三种方法对比**:

| 方法 | 速度 | 精度 | 适用场景 |
|------|------|------|---------|
| 多项式映射 | 最快 | 中等 | 大多数场景 |
| 3D LUT | 中等 | 高 | 需要高精度 |
| 直接映射 | 较慢 | 最高 | 色块数量多 |

**选择建议**:
- 首次使用：选择"多项式映射"
- 需要高精度：选择"3D LUT"
- 色块数量多：选择"直接映射"

### 5. 执行颜色校正

**操作**:
- 选择校正方法
- 点击"✨ 开始校正"按钮
- 等待处理完成

**处理时间**:
- 多项式映射：50-100ms
- 3D LUT：100-200ms
- 直接映射：200-500ms

### 6. 查看结果

**显示内容**:
- 原始图像（左侧）
- 校正后的图像（右侧）
- 质量指标（Delta E 值）

**质量评估**:
- Delta E < 1: 人眼无法察觉
- Delta E 1-3: 优秀
- Delta E 3-5: 很好
- Delta E 5-10: 良好
- Delta E > 10: 需要改进

### 7. 生成对比图像

**操作**:
- 点击"🔄 生成对比"按钮
- 等待生成完成
- 查看对比结果

**对比图像**:
- 显示原图和校正图的并排对比
- 帮助直观评估校正效果

### 8. 下载结果

**操作**:
- 点击"⬇️ 下载结果"按钮
- 浏览器自动下载 JPEG 文件
- 文件名：`corrected_image.jpg`

### 9. 重置并重新开始

**操作**:
- 点击"🔄 重置"按钮
- 确认重置
- 所有数据将被清空

## 🎨 界面说明

### 左侧面板：上传区域

- **校准图像**: 上传包含 ColorChecker 的照片
- **目标图像**: 上传需要校正的照片
- **预览**: 显示已上传的图像
- **状态**: 显示上传结果

### 中间面板：参数设置

- **校正方法**: 选择三种方法之一
- **操作按钮**: 执行各种操作
- **进度显示**: 显示处理进度
- **状态信息**: 显示当前状态

### 右侧面板：结果展示

- **原始图像**: 显示上传的目标图像
- **校正后**: 显示校正结果
- **质量指标**: 显示 Delta E 值
- **对比图像**: 显示并排对比

## 💡 使用技巧

### 1. 获得最佳效果

- 确保 ColorChecker 清晰可见
- 光线条件要一致
- 避免阴影和反光
- 色卡占据图像 20-50%

### 2. 处理色卡检测失败

- 调整拍摄角度
- 改善光线条件
- 确保色卡完整可见
- 尝试不同的图像

### 3. 校正效果不理想

- 尝试不同的校正方法
- 检查校准图像质量
- 确保光源条件相似
- 查看 Delta E 值

### 4. 加快处理速度

- 使用"多项式映射"方法
- 降低图像分辨率
- 关闭其他应用

### 5. 批量处理

- 使用相同的校准图像
- 逐个上传目标图像
- 下载每个结果
- 使用"重置"按钮清空数据

## 🔧 常见问题

### Q: 上传失败怎么办？

A: 
- 检查文件格式（JPG、PNG、BMP、TIFF）
- 检查文件大小（< 50MB）
- 检查网络连接
- 查看浏览器控制台错误信息

### Q: 色卡检测失败怎么办？

A:
- 确保色卡清晰可见
- 改善光线条件
- 调整拍摄角度
- 确保色卡占据 20-50% 的图像

### Q: 校正效果不好怎么办？

A:
- 尝试不同的校正方法
- 检查校准图像质量
- 确保光源条件相似
- 查看 Delta E 值评估质量

### Q: 如何处理大文件？

A:
- 压缩图像分辨率
- 使用在线图像压缩工具
- 分割大图像为多个小图像

### Q: 支持哪些文件格式？

A: JPG、PNG、BMP、TIFF

### Q: 最大文件大小是多少？

A: 50MB

### Q: 可以同时处理多个图像吗？

A: 可以，但需要逐个上传和处理

### Q: 如何保存处理历史？

A: 下载每个结果，手动保存

## 📊 性能指标

| 操作 | 时间 |
|------|------|
| 上传 1MB 图像 | 1-2 秒 |
| 检测色卡 | 100-200ms |
| 多项式校正 | 50-100ms |
| 3D LUT 校正 | 100-200ms |
| 直接映射校正 | 200-500ms |
| 生成对比图像 | 100-300ms |
| 下载结果 | 1-2 秒 |

## 🌐 浏览器兼容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+
- ✅ 移动浏览器（iOS Safari、Chrome Mobile）

## 📱 移动设备使用

- 支持响应式设计
- 支持触摸操作
- 支持拖拽上传
- 支持文件选择

## 🔒 隐私和安全

- 所有处理在本地进行
- 不上传到云端
- 处理完成后自动清空
- 支持离线使用

## 📞 获取帮助

- 查看 README.md 了解项目信息
- 查看 WEB_SERVER.md 了解服务器配置
- 查看 TECHNICAL.md 了解技术细节
- 查看 INTEGRATION.md 了解集成方法

## 🚀 下一步

1. 启动服务器
2. 打开浏览器访问应用
3. 上传校准和目标图像
4. 执行颜色校正
5. 下载结果

---

**准备好了吗？** 👉 运行 `bash run_server.sh` 开始使用！

